(this.webpackJsonpbudget_wc=this.webpackJsonpbudget_wc||[]).push([[0],{406:function(e,t,a){},563:function(e,t,a){e.exports=a(842)},568:function(e,t,a){},582:function(e,t){},842:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(18),o=a.n(i),l=(a(568),a(406),a(867)),s=a(407),c=a(333),u=a(103),d=a(503),h=a.n(d);function f(){return r.a.createElement(l.a,{position:"sticky"},r.a.createElement(s.a,null,r.a.createElement(c.a,{edge:"start",color:"inherit","aria-label":"menu"},r.a.createElement(h.a,null)),r.a.createElement(u.a,{variant:"h6"},"USAC Budget/Spendings 2018-2019")))}var m=a(63),p=a(64),g=a(90),v=a(89),y=a(165),b=(a(496),a(869)),k=a(531);function C(e){if(Number.isNaN(e))return"";var t=e.toFixed(2).split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function E(e){if(Number.isNaN(e))return"";var t="";return e>=1e6?(t="M",e/=1e6):e>=1e3&&(t="K",e/=1e3),e.toPrecision(3)+t}var w=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).callbacks={getWordTooltip:function(e){return"".concat(e.text," has $").concat(E(e.value)," in the category.")},onWordClick:n.getCallback("onWordClick").bind(Object(y.a)(n)),onWordMouseOut:n.getCallback("onWordMouseOut").bind(Object(y.a)(n)),onWordMouseOver:n.getCallback("onWordMouseOver").bind(Object(y.a)(n))},n.options={fontFamily:"impact",fontSizes:[5,60],fontStyle:"normal",fontWeight:"normal",scale:"log",deterministic:!0,rotations:4,rotationAngles:[-45,90],transitionDuration:200},n.state={words:[{text:"Loading...",value:100}]},n}return Object(p.a)(a,[{key:"componentDidMount",value:function(){this.props.dataloader.addChangeCallback(this.setWords.bind(this))}},{key:"render",value:function(){return r.a.createElement("div",{style:{height:"80vh"},hidden:this.props.hidden},r.a.createElement(k.a,{callbacks:this.callbacks,words:this.props.dataloader.getWordList(),options:this.options}))}},{key:"getCallback",value:function(e){var t=this;return function(a,n){var r="onWordMouseOut"!==e;Object(b.a)(n.target).on("click",(function(){r&&t.props.dataloader.addKeywordFilter(a.text)})).transition().attr("background","white").attr("text-decoration",r?"underline":"none")}}},{key:"setWords",value:function(){this.forceUpdate()}}]),a}(n.Component),O=a(511),j=a.n(O),x=a(882),F=a(883),D=a(884),W=a(885),M=a(886),S=a(887),N=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(m.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).columns=[{title:"Date",field:"date",type:"date"},{title:"Amount",field:"amount",type:"currency"},{title:"Description",field:"description"},{title:"Department",field:"department"},{title:"Fund",field:"fund"},{title:"Division",field:"division"},{title:"Event",field:"event"},{title:"GL",field:"gl"}],e.options={showTitle:!0,sorting:!0,exportButton:!0,padding:"dense",paging:!0,search:!1,draggable:!1,headerStyle:{position:"sticky",top:0},exportAllData:!0},e.icons={Export:x.a,SortArrow:F.a,FirstPage:D.a,LastPage:W.a,NextPage:M.a,PreviousPage:S.a},e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.dataloader.addChangeCallback((function(){e.forceUpdate()}))}},{key:"render",value:function(){return r.a.createElement(j.a,{options:this.options,columns:this.columns,icons:this.icons,data:this.props.dataloader.getRecords(),title:"Transactions: total $"+C(this.props.dataloader.getTotal())})}}]),a}(n.Component),_=a(891),A=a(881),K=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){return Object(m.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.dataloader.addChangeCallback((function(){return e.forceUpdate()}))}},{key:"render",value:function(){var e=this,t=this.props.dataloader.getFilters();return r.a.createElement(_.a,{separator:">",style:this.props.style},r.a.createElement(A.a,{key:-1,color:"textPrimary",onClick:function(){return e.props.dataloader.sliceFilter(0)}},"Transactions($",E(this.props.dataloader.getDatasetTotal()),")"),t.slice(0,-1).map((function(t,a){return r.a.createElement(A.a,{key:a,color:"textSecondary",onClick:function(){return e.props.dataloader.sliceFilter(a+1)}},t.category,": ",t.name,"($",E(t.amount),")")})),t.length>0?r.a.createElement(u.a,{color:"textPrimary",key:t.length},t[t.length-1].category,": ",t[t.length-1].name,"($",E(t[t.length-1].amount),")"):null)}}]),a}(n.Component),L=a(186),P=a(114),T=a(77),B=a(518),$=function(){function e(t){var a=this;Object(m.a)(this,e),this.data=[],this.filters=[],this.dataChangeCallbacks=[],this.dataset=void 0,this.total_amount=0,this.dataset=e.parseDataset(t),B.parse(window.location.pathname+"/expense_summary_"+this.dataset+".csv",{download:!0,header:!0,complete:function(e){a.data=e.data.map((function(e){return e.date=new Date(1e3*Number.parseFloat(e.date)),e.amount=Number.parseFloat(e.amount),e.words=e.__parsed_extra||[],e})),a.onLoad(t)}})}return Object(p.a)(e,[{key:"onLoad",value:function(e){this.total_amount=this.data.reduce((function(e,t){return e+t.amount}),0),this.parseQuery(e),this.listChangeCallback()}},{key:"parseQuery",value:function(e){var t=this;"?"===e[0]&&(e=e.slice(1));var a=this.dataChangeCallbacks;this.dataChangeCallbacks=[];try{e.split("&").forEach((function(e){if(e.includes("=")){var a=e.indexOf("="),n=e.substr(0,a),r=e.substr(a+1);switch(n){case"keyword":t.addKeywordFilter(r);break;case"fund":case"division":case"department":case"gl":case"event":t.addCategoryFilter(n,atob(r));break;case"amount":if(!r.includes(".."))return;var i=r.split("..").map((function(e){return function(e){var t=1;return e.includes("K")&&(t=1e3,e=e.replace("K","")),e.includes("M")&&(t=1e6,e=e.replace("M","")),e.includes("B")&&(e=e.replace("B",""),t=1e9),Number.parseFloat(e)*t}(e)}));t.addAmountFilter(i[0],i[1])}}}))}catch(n){console.log(n)}this.dataChangeCallbacks=a}},{key:"setQueryString",value:function(){var e="d="+this.dataset+this.filters.reduce((function(e,t){switch(t.category){case"keyword":return e+"&keyword="+t.name;case"amount":return e+"&amount="+t.name.replace("~","..");default:return e+"&"+t.category+"="+btoa(t.name)}}),""),t=window.location.href;t.includes("?")&&(t=t.substr(0,t.indexOf("?"))),window.history.pushState({path:t+"?"+e},"",t+"?"+e)}},{key:"listChangeCallback",value:function(){this.dataChangeCallbacks.forEach((function(e){return e()})),this.setQueryString()}},{key:"addChangeCallback",value:function(e){this.dataChangeCallbacks.push(e)}},{key:"getRecords",value:function(){return 0===this.data.length?[]:0===this.filters.length?this.data:this.filters[this.filters.length-1].index}},{key:"getWordList",value:function(){if(0===this.data.length)return[];var e=new Map;this.getRecords().forEach((function(t){t.words.forEach((function(a){e.set(a,(e.get(a)||0)+t.amount)}))}));var t,a=[],n=Object(T.a)(e.entries());try{for(n.s();!(t=n.n()).done;){var r=Object(P.a)(t.value,2),i=r[0],o=r[1];a.push({text:i,value:o})}}catch(l){n.e(l)}finally{n.f()}return a.sort((function(e,t){return e.value-t.value})),a}},{key:"getCategories",value:function(e){if(0===this.data.length)return[];var t=new Map;this.getRecords().forEach((function(a){var n=a[e];t.set(n,(t.get(n)||0)+a.amount)}));var a,n=[],r=Object(T.a)(t.entries());try{for(r.s();!(a=r.n()).done;){var i=Object(P.a)(a.value,2),o=i[0],l=i[1];n.push({text:o,value:l})}}catch(s){r.e(s)}finally{r.f()}return n.sort((function(e,t){return e.value-t.value})),n}},{key:"getTotal",value:function(){return 0===this.filters.length?this.total_amount:this.filters[this.filters.length-1].amount}},{key:"getDatasetTotal",value:function(){return this.total_amount}},{key:"getFilters",value:function(){return this.filters}},{key:"getDatasetName",value:function(){return this.dataset}},{key:"sliceFilter",value:function(e){this.filters=this.filters.slice(0,e),this.listChangeCallback()}},{key:"addKeywordFilter",value:function(e){if(0!==this.data.length&&!this.filters.reduce((function(t,a){return t||"keyword"===a.category&&a.name===e}),!1)){var t;if(0!==this.filters.length)t=this.filters[this.filters.length-1].index.filter((function(t){return t.words.includes(e)}));else t=this.data.filter((function(t){return t.words.includes(e)}));this.filters.push({category:"keyword",name:e,index:t,amount:t.reduce((function(e,t){return e+t.amount}),0)}),this.listChangeCallback()}}},{key:"addCategoryFilter",value:function(e,t){if(0!==this.data.length&&!this.filters.reduce((function(a,n){return a||n.category===e&&n.name===t}),!1)){var a;if(0!==this.filters.length)a=this.filters[this.filters.length-1].index.filter((function(a){return a[e]===t}));else a=this.data.filter((function(a){return a[e]===t}));this.filters.push({category:e,name:t,index:a,amount:a.reduce((function(e,t){return e+t.amount}),0)}),this.listChangeCallback()}}},{key:"addAmountFilter",value:function(e,t){if(0!==this.data.length){var a;if(0!==this.filters.length)"amount"===this.filters[this.filters.length-1].category&&(this.filters=this.filters.slice(0,-1)),a=this.filters[this.filters.length-1].index.filter((function(a){return e<=a.amount&&a.amount<=t}));else a=this.data.filter((function(a){return e<=a.amount&&a.amount<=t}));this.filters.push({category:"amount",name:E(e)+"~"+E(t),index:a,amount:a.reduce((function(e,t){return e+t.amount}),0)}),this.listChangeCallback()}}}],[{key:"parseDataset",value:function(e){"?"===e[0]&&(e=e.slice(1));var t=e.split("&").filter((function(e){return e.startsWith("d=")}));return 0===t.length?"2018":t[0].substr(2)}}]),e}(),R=a(194),U=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(m.a)(this,a);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).divElement=null,e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.dataloader.addChangeCallback((function(){return e.forceUpdate()}))}},{key:"render",value:function(){var e=this,t=this.props.dataloader.getCategories(this.props.category);return r.a.createElement("div",{style:{height:"80vh"},hidden:this.props.hidden||!1,ref:function(t){return e.divElement=t}},r.a.createElement(R.c,{height:"100%",width:"100%"},r.a.createElement(R.b,null,r.a.createElement(R.a,{data:t,dataKey:"value",nameKey:"text",fill:this.getColor(),label:function(e){var t=e.percent,a=e.name;return(t||0)>.005?a:""},labelLine:!1,onClick:function(t){return e.props.dataloader.addCategoryFilter(e.props.category,t.text)}}),r.a.createElement(R.d,{formatter:function(e){return"$"+E(e)},contentStyle:{padding:"0 5px",margin:0,borderRadius:5}}))))}},{key:"getColor",value:function(){switch(this.props.category){case"fund":return"#ef5350";case"division":return"#ab47bc";case"department":return"#26c6da";case"gl":return"#26a69a";case"event":return"#d4e157"}}}]),a}(n.Component),Q=a(889),q=a(877),G=function(e){Object(g.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this,e)).loader=void 0,n.state={value:0},n.loader=new $(n.props.query),n}return Object(p.a)(a,[{key:"render",value:function(){var e=this;return console.log("view render"),r.a.createElement(L.a,{variant:"outlined",style:{margin:"0 10%"}},r.a.createElement(K,{style:{margin:10},dataloader:this.loader}),r.a.createElement(Q.a,{value:this.state.value,onChange:function(t,a){e.setState({value:a})},indicatorColor:"primary",textColor:"primary",centered:!0},r.a.createElement(q.a,{label:"Keywords"}),r.a.createElement(q.a,{label:"Fund"}),r.a.createElement(q.a,{label:"Division"}),r.a.createElement(q.a,{label:"Department"}),r.a.createElement(q.a,{label:"GL"}),r.a.createElement(q.a,{label:"Event"})),r.a.createElement(w,{hidden:0!==this.state.value,dataloader:this.loader}),r.a.createElement(U,{hidden:1!==this.state.value,category:"fund",dataloader:this.loader}),r.a.createElement(U,{hidden:2!==this.state.value,category:"division",dataloader:this.loader}),r.a.createElement(U,{hidden:3!==this.state.value,category:"department",dataloader:this.loader}),r.a.createElement(U,{hidden:4!==this.state.value,category:"gl",dataloader:this.loader}),r.a.createElement(U,{hidden:5!==this.state.value,category:"event",dataloader:this.loader}),r.a.createElement(N,{dataloader:this.loader}))}}]),a}(r.a.Component);var J=function(){return r.a.createElement("div",null,r.a.createElement(f,null),r.a.createElement(G,{query:window.location.search}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[563,1,2]]]);
//# sourceMappingURL=main.c6c2b7f2.chunk.js.map